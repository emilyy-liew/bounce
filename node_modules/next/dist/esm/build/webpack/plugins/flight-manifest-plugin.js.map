{"version":3,"sources":["../../../../src/build/webpack/plugins/flight-manifest-plugin.ts"],"names":["path","webpack","sources","CLIENT_REFERENCE_MANIFEST","SYSTEM_ENTRYPOINTS","relative","isClientComponentEntryModule","isCSSMod","getProxiedPluginState","traverseModules","nonNullable","WEBPACK_LAYERS","getClientReferenceModuleKey","pluginState","serverModuleIds","edgeServerModuleIds","ASYNC_CLIENT_MODULES","PLUGIN_NAME","ClientReferenceManifestPlugin","constructor","options","dev","appDir","Set","apply","compiler","hooks","compilation","tap","normalModuleFactory","dependencyFactories","set","dependencies","ModuleDependency","dependencyTemplates","NullDependency","Template","make","processAssets","name","stage","Compilation","PROCESS_ASSETS_STAGE_OPTIMIZE_HASH","assets","createAsset","context","manifest","ssrModuleMapping","edgeSSRModuleMapping","clientModules","clientRequestsSet","collectClientRequest","mod","resource","buildInfo","rsc","requests","forEach","r","add","chunkGroups","chunkGroup","getAppPathRequiredChunks","chunks","map","requiredChunk","has","files","file","endsWith","id","flat","filter","requiredChunks","recordModule","chunkCSS","isCSSModule","layer","appClient","type","_identifier","slice","lastIndexOf","moduleReferences","moduleIdMapping","edgeModuleIdMapping","ssrNamedModuleId","resourceResolveData","startsWith","replace","exportName","exportsInfo","moduleGraph","getExportsInfo","isAsyncModule","cjsExports","dep","base","names","clientRefs","Boolean","esmResource","test","sep","addClientReference","async","edgeExportName","addSSRIdMapping","moduleExportedKeys","exports","exportInfo","provided","key","chunk","chunkModules","chunkGraph","getChunkModulesIterable","f","modId","getModuleId","anyModule","modules","concatenatedMod","json","JSON","stringify","undefined","RawSource"],"mappings":"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"}