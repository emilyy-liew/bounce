{"version":3,"sources":["../../../../src/server/lib/incremental-cache/fetch-cache.ts"],"names":["LRUCache","FETCH_CACHE_HEADER","CACHE_ONE_YEAR","getDerivedTags","memoryCache","FetchCache","constructor","ctx","debug","process","env","NEXT_PRIVATE_DEBUG_CACHE","headers","revalidatedTags","_requestHeaders","newHeaders","JSON","parse","k","scHost","SUSPENSE_CACHE_URL","scBasePath","SUSPENSE_CACHE_BASEPATH","SUSPENSE_CACHE_AUTH_TOKEN","cacheEndpoint","console","log","maxMemoryCacheSize","max","length","value","kind","stringify","props","Error","data","body","html","pageData","revalidateTag","tag","res","fetch","method","next","internal","ok","status","err","warn","get","key","fetchCache","fetchUrl","fetchIdx","Date","now","lastModified","undefined","start","fetchParams","fetchType","error","text","cached","json","cacheState","age","parseInt","Object","keys","set","innerData","derivedTags","tags","some","includes","revalidate","toString","join"],"mappings":"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"}