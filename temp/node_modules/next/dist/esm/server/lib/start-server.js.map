{"version":3,"sources":["../../../src/server/lib/start-server.ts"],"names":["http","isIPv6","Log","normalizeRepeatedSlashes","initialEnv","genExecArgv","getNodeOptionsWithoutInspect","getFreePort","startServer","dir","prevDir","port","isDev","hostname","useWorkers","allowRetry","keepAliveTimeout","onStdout","onStderr","process","sockets","Set","worker","handlersReady","handlersError","isNodeDebugging","execArgv","some","localArg","startsWith","env","NODE_OPTIONS","match","handlersPromise","Promise","resolve","reject","requestHandler","_req","_res","Error","upgradeHandler","_socket","_head","server","createServer","req","res","undefined","add","on","delete","err","statusCode","end","error","url","console","socket","head","destroy","portRetryCount","code","warn","listen","exit","targetHost","addr","address","host","normalizedHostname","appUrl","ready","httpProxy","require","renderServerPath","jestWorkerPath","replace","Worker","routerWorker","numWorkers","maxRetries","forkOptions","FORCE_COLOR","PORT","exposedMethods","didInitialize","_worker","_workerPool","_workers","_child","signal","workerStdout","getStdout","workerStderr","getStderr","data","stdout","write","stderr","routerPort","initialize","dev","workerType","getProxyServer","pathname","targetUrl","proxyServer","createProxy","target","changeOrigin","ignorePath","xfwd","ws","followRedirects","_err","urlParts","split","urlNoQuery","cleanUrl","setHeader","web","next","app","httpServer","customServer","getRequestHandler","getUpgradeHandler","prepare","teardown","close","forEach"],"mappings":"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"}